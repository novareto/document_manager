DOCTEST
=======

This Doctest should describe the Flow between the App in two
perspectives.

1) The Insurance which makes initial contents (User, Files, Documents)
2) The Client which logs in then and work on his *tasks*
   These Tasks are in Principal: Fill pre-defined Forms.


The Insurance creates an empty User.


  >>> api_app = getfixture('api_app')
  >>> from webtest import TestApp
  >>> app = TestApp(api_app)
  >>> app
  <webtest.app.TestApp object at 0...>

  >>> user = dict(uid="b12345", loginname="b12345678", password="passwort")
  >>> resp = app.post_json("/user.add", user)
  >>> resp.status
  '201 Created'

  >>> resp = app.get("/users/b12345")
  >>> resp.status
  '200 OK'


The Insurance creates an empty File.

  >>> resp = app.put_json("/users/b12345/file.add", {'az': "4712", 'mnr': '12', 'vid': '12'})
  >>> resp.status
  '201 Created'


Now the user should be able to Login: Lets proove this.
For this we have to create a new Instance of the HTML-App

  >>> web_app = getfixture('web_app')
  >>> from webtest import TestApp
  >>> app = TestApp(web_app)

  >>> landing_page_anon = app.get('/')
  >>> landing_page_anon.status
  '302 Found'

We don't have the permission yet, so we get redirected to the login-page


  >>> landing_page_anon.location
  'http://localhost/login'

Let's login

  >>> user['form.trigger'] = "trigger.speichern"
  >>> login = app.post('/login', user)
  >>> login.location
  'http://localhost/'
  >>> login.status
  '302 Found'

Let's see the Login-Page

  >>> lp = app.get(login.location)
